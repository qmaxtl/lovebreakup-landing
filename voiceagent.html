<script>
  const micBtn = document.getElementById('micBtn');
  const transcriptDiv = document.getElementById('transcript');

  // ✅ Initialize Vapi SDK
  const vapi = new Vapi({
    apiKey: "75c64877-597f-4833-ab36-9261f74dc5ea", // your public key
    assistant: {
      id: "a039c975-4660-4630-92e3-51582df6b41f", // your assistant ID
    }
  });

  // ✅ Track state
  let isListening = false;

  micBtn.addEventListener('click', () => {
    if (!isListening) {
      vapi.start();
      micBtn.innerText = '🎤 Listening...';
      transcriptDiv.innerHTML = `<p class="text-gray-500 italic">Listening...</p>`;
      isListening = true;
    } else {
      vapi.stop();
      micBtn.innerText = '🎙️ Tap to Talk';
      isListening = false;
    }
  });

  // ✅ Show transcript
  vapi.on('transcript', (data) => {
    transcriptDiv.innerHTML = `<p class="text-gray-800 font-semibold">🗣️ You said:</p><p class="mt-2">${data.transcript}</p>`;
  });

  // ✅ Reset button after response
  vapi.on('end', () => {
    micBtn.innerText = '🎙️ Tap to Talk';
    isListening = false;
  });

  // ✅ Handle errors
  vapi.on('error', (error) => {
    transcriptDiv.innerHTML = `<p class="text-red-600">❌ Error: ${error.message}</p>`;
    micBtn.innerText = '🎙️ Tap to Talk';
    isListening = false;
  });
</script>
